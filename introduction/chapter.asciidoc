[[introduction]] 
== Введение в CloudForms и Manageiq

Добро пожаловать в это руководство по освоению функции автоматизации как CloudForms, так и Manageiq. Прежде чем мы начнем наше путешествие через автоматизация, стоит провести общий тур по их возможностям, чтобы установить контекст для всего, что мы будем изучать. Поскольку Manageiq является проектом _upstream_ с открытым исходным кодом для Red Hat Cloudforms (мы обсудим это позже в этой главе), два продукта очень похожи.

=== What are CloudForms and ManageIQ?

CloudForms и Manageiq являются платформами управления _cloud, которые также довольно хороши в управлении традиционными продуктами виртуализации сервера, таких как VMware vSphere или Ovirt. Эта широкая способность делает их идеальными в качестве менеджеров по облаку _hybrid_, способных управлять как публичными облаками, так и локальные частные облака и виртуальные инфраструктуры. Они предоставляют единый интерфейс управления в гибридную среду, что позволяет достичь кроссплатформенного оркестровки с относительной простотой.

Хотя управление было первоначально разработано как виртуализация и _infrastructure в качестве облачного менеджера Service_ (IAAS), CloudForms 4.0/Manageiq _capablanca_ введен поддержку для управления контейнерами Docker, включая OpenShift Enterprise 3.x _platform как Service_ (PAAS) Cloud Solution. С помощью CloudForms 4.2/Manageiq _euwe_ эта возможность была расширена для управления облачным ориентированным программным обеспечением и хранением, а также компонентами управления конфигурацией и промежуточного программного обеспечения в нашем предприятии.

'''
.
****
Платформы Cloud Management (CMP) - это программные инструменты, которые позволяют интегрированному управлению государственными, частными и гибридными облачными средами. Существует несколько требований, которые обычно считаются необходимыми для того, чтобы продукт был классифицирован как платформа управления облаком. Это:

* Заказ услуг на основе каталога на основе каталога на основе каталога
* Измерение и выставление счетов облачных рабочих нагрузок
* Оптимизация и управление рабочей нагрузкой на основе политики
* Оркестровка и автоматизация рабочего процесса
* Возможность интеграции с внешними инструментами и системами
* Контроль доступа на основе ролей (RBAC) и многопользование
****
'''

=== Providers

Cloudforms и Manageiq управляют каждым облаком, контейнером или виртуальной средой, используя модульные подкомпоненты, называемые _providers_. Каждый поставщик содержит функциональность, необходимую для подключения и мониторинга его конкретной целевой платформы, и эта специализация поставщика позволяет абстрагировать общие функции управления облаком в основной продукт. В соответствии с концепцией _manager of Managers_, поставщики общаются со своей основной платформой облака или инфраструктуры, используя нативные API, опубликованные для менеджера платформы (например, VMware vCenter Server с использованием API vSphere SOAP).

Подключаемый характер архитектуры поставщика делает относительно простым разработкой новых поставщиков для поддержки дополнительных облачных и инфраструктурных платформ. Поставщики широко разделены на категории, а в Cloudforms 4.2/Manageiq _euwe_ Это _cloud_, _infrastructure_, _container_, _configuration Management_, _network_, _middleware_ и _storage_.

==== Cloud Providers

Облачные провайдеры в CloudForms 4.2 и Manageiq _euwe_ позволяют нам управлять тремя облаками _public_; Amazon EC2, Google Compute Engine и Microsoft Azure. Существует также облачный провайдер, который может подключаться к и управлять и управлять _private_ или _on-premise_ Red Hat Platform Platform (OSP) (это _overcloud_ в том случае, когда OSP управляет директором Red Hat Platform Platform). Manageiq _euwe_ также имеет возможность добавить vmware vcloud в качестве управляемого облачного поставщика.

==== Infrastructure Providers

Поставщики инфраструктуры позволяют нам управлять тремя традиционными продуктами инфраструктуры: VMware vCenter Server, диспетчер Red Hat (Enterprise) и Microsoft System Center Virtual Machine Manager. Существует также поставщик инфраструктуры, который может подключаться к частному или локальному директору платформы Red Hat Platform _underCloud_.

==== Container Providers

Провайдеры контейнеров позволяют нам подключаться к управляющим контейнерами и управлять и управлять. CloudForms 4.2 поддерживает контейнерную платформу OpenShift в качестве диспетчера контейнеров, но Manageiq _euwe_ также добавляет Kubernetes и OpenShift Origin в качестве доступных менеджеров.

==== Configuration Management Providers

Поставщики управления конфигурацией позволяют нам использовать возможности спутника Red Hat (или бригадир) и Ansible Tower для управления конфигурацией. Спутниковый провайдер позволяет нам использовать бригадир _host Groups_ и расширяет возможность обеспечения включать серверы _bare-metal_ (то есть не виртуальные). Поставщик Ansible Tower позволяет нам выполнять задачи Ansible в рамках автоматического рабочего процесса.

==== Network Providers

Сетевые провайдеры позволяют нам визуализировать и управлять программными компонентами сети в наших Amazon EC2, Google Compute Engine, Microsoft Azure или OpenStack Clouds. Сетевые провайдеры автоматически настроены, когда мы добавляем любого из общественных или частных облачных провайдеров или поставщика инфраструктуры OSP.

==== Storage Providers

Поставщики хранения позволяют нам управлять программными компонентами хранения в нашем облаке OpenStack. CloudForms 4.2/Manageiq _euwe_ ввел поддержку модулей хранения gar -incinder openstack (блока) и Swift (Object).

==== Middleware Providers

CloudForms 4.2/Manageiq _euwe_ представила новый тип провайдера промежуточного программного обеспечения в качестве предварительного просмотра технологии. Это обеспечивает инвентаризацию, метрики и события для серверов приложений JBoss и баз данных EAP, подключившись к соответствующему настроенным ястребому экземпляру.

==== Mixing and Matching Providers

При развертывании CloudForms или Manageiq на нашем предприятии мы часто подключаем к нескольким провайдерам. Мы можем проиллюстрировать это с примером компании.

===== Company XYZ Inc.

Наша пример организации имеет установленную виртуальную среду VMware VSPHERE 6.0, содержащая много сотен виртуальных машин. Эта виртуальная инфраструктура обычно используется для стабильных, долгоживущих виртуальных машин, и здесь расположены многие из важнейшей базы данных организации, сервисов каталогов и файловых серверов. Приблизительно половина виртуальных машин VMware запускает сноску Red Hat Enterprise Linux: [CloudForms и Manageiq являются нейтральной операционной системой виртуальной машины; Они могут с одинаковой легкостью управлять Windows, Red Hat, Fedora, Debian, Ubuntu или SUSE (или их производными), а также для облегчения исправления, обновления и управления конфигурацией этих виртуальных машин, организация имеет сервер Satellite 6.

Компания XYZ является крупным производителем нескольких разновидностей виджетов, а цикл испытаний на разработку виджетов включает в себя создание многих недолговечных экземпляров в частном облаке OpenStack, чтобы пройти велосипед через тестовые наборы. Разработчикам нравится иметь каталог услуг, из которого они могут заказать одну из многочисленных сред, и в любое время может быть несколько сотен экземпляров с различными тестовыми конфигурациями.

Веб-разработчики в компании находятся в процессе повторного развития основного интернет-портала в качестве масштабируемой рабочей нагрузки общего облака, размещенной в Amazon EC2. Веб -портал предоставляет для клиентов богатый каталог продуктов, онлайн -документацию, ноулгебаз и торговую зону электронной коммерции.

Эта организация использует CloudForms для управления рабочими процессами, которые предоставляют виртуальные машины в виртуальную инфраструктуру vSphere, Amazon EC2 и OpenStack. У пользователей есть каталог самообслуживания для предоставления отдельных рабочих нагрузок виртуальной машины в VMware или Amazon, или целые тестовые люксы в OpenStack. Рабочие процессы Orchestration CloudForms помогают в обслуживании _Image Factory_, который поддерживает обновления и опубликованных изображений виртуальных машин в виде шаблонов VMware, изображений Amazon Machine (AMIS) и OpenStack _glance_ Images.

В рамках процесса провинции CloudForms также управляет рабочими процессами интеграции, которые позволяют автоматически зарегистрироваться на сервере Satellite 6 и базу данных управления конфигурацией быть автоматически зарегистрированы на сервере Satellite 6. Это гарантирует, что недавно предоставленные виртуальные машины настроены Puppet в соответствии с роли сервера, исправленные с последними обновлениями, с полным инвентаризацией, видимым в системе Help-Desk.

[[i2]]
.Cloudforms поставщики и рабочие процессы
image::images/cloudforms_ripicture.png[Rich Picture,600,align="center"]
{zwsp} +

=== The Capabilities

Мы уже упоминали некоторые возможности CloudForms и ManageiQ, таких как _orchestration_, a _service Catalog_ и _integration Workflows_. Давайте посмотрим на четыре основных областях возможностей: понимание, управление, автоматизировать и интегрировать.

==== Insight

_Insight_ - это процесс сбора интеллекта на нашей виртуальной или облачной инфраструктуре, чтобы мы могли эффективно управлять им. Это один из самых фундаментальных, но важных возможностей продукта.

Когда мы сначала подключаем поставщика, Cloudforms и Manageiq начинают процесс _discovery_ виртуальной или облачной инфраструктуры. Поставщик инфраструктуры будет собирать и сохранять подробности всей виртуальной инфраструктуры, включая кластеры, гипервизоры, данные данных, виртуальные машины и отношения между каждым из них. Поставщики облаков обычно не обнажают детали инфраструктуры, поэтому облачные провайдеры обычно собирают и контролируют информацию, конкретную арендатор, о облачных компонентах, таких как экземпляры, изображения, зоны доступности, сети и группы безопасности.

Оба инструмента также хранят и обрабатывают любые данные в режиме реального времени или исторические показатели производительности, которые раскрывает поставщик. Они используют исторические данные для расчета полезных аналитических анализов, таких как изображение или предложения в правильном размере виртуальной машины, и рекомендации по планированию потенциала. Они используют статистику производительности в реальном времени и события включения/выкл., Чтобы дать нам представление об использовании рабочей нагрузки, а также используют эту информацию для расчета измерения и платежных затрат.

Одна из ролей сервера CloudForms или Manageiq - это _smart proxy_. Сервер с этой ролью способен инициировать анализ _smartState Analysis_ на виртуальной машине, шаблоне, экземпляре или даже докером. Анализ SmartState (также известный как _fleecing_) - это запатентованная технология, которая сканирует изображение диска контейнера или виртуальной машины для изучения его содержимого. Сканирование обнаруживает, что пользователи и группы были добавлены, были установлены приложения, которые ищут и поиск и, необязательно, получает содержимое указанных файлов конфигурации или настройки реестра Windows. Это операция без агента, которая не требует включения виртуальной машины.

Как CloudForms, так и Manageiq позволяют нам применять теги к инфраструктуре или облачным компонентам, чтобы помочь нам выявить и классифицировать наши рабочие нагрузки или ресурсы таким образом, чтобы иметь смысл для нашей организации. Эти теги могут указать отдел владения, центр затрат, тип операционной системы, например, местоположение или классификацию рабочей нагрузки. Мы можем создавать мощные фильтры в WebUI, которые позволяют нам отображать управляемые компоненты, такие как VMS вдоль организационных и бизнес -линий, а не физическое размещение или характеристика.

Чтобы завершить сводку их способности к пониманию, CloudForms и Manageiq также обладают мощной возможностью отчетности, которые можно использовать для создания онлайн или экспортируемых отчетов CSV или PDF.

==== Control

Мы можем использовать функциональность _control_ CloudForms и Manageiq для обеспечения соблюдения политик безопасности и конфигурации, используя информацию, полученную из Insight. Например, анализ Smartstate виртуальной машины может обнаружить программный пакет, содержащий известную критическую уязвимость безопасности. Мы могли бы реализовать политику _control, чтобы выключить виртуальную машину или перенести ее в гипервизор в карантинной сети, чтобы ее можно было исправить.

Используя статистику производительности в реальном времени, мы можем настроить оповещения, чтобы предупредить нас, когда критические виртуальные машины работают на необычайно высоких уровнях использования. Многие инструменты мониторинга могут сделать это, но с помощью Manageiq мы также могли бы использовать такое предупреждение, чтобы запустить автоматический рабочий процесс для динамического масштабирования рабочей нагрузки приложения путем предоставления большего количества серверов.

Мы можем отслеживать соответствие политикам корпоративной безопасности, сбором и разумной обработкой содержимого выбранных файлов конфигурации. Таким образом, мы могли бы обнаружить, например, отключен Selinux, или что SSHD работает с небезопасной конфигурацией. Мы можем автоматически запустить такие правила соответствия и отметить виртуальную машину, как _noncompliant_, после чего его статус будет немедленно видим в Webui.

==== Automate

Одной из самых мощных функций CloudForms и Manageiq является их способность к _automate_ оркестровку рабочих нагрузок и ресурсов в нашей виртуальной инфраструктуре или облаке. Automate позволяет нам создавать и использовать мощные рабочие процессы, используя язык сценариев Ruby или задания, а также функции, предоставляемые _Automation Engine_, например, _State Machines_ и _Service Models_.

Cloudforms и Manageiq предварительно настроены с большим количеством сноски рабочих процессов из коробки: [CloudForms фактически отправляется с дополнительными сценариями автоматизации, которые не находятся в управлении], чтобы организовать такие вещи, как:

* Обеспечение или масштабирование _workloads_, таких как виртуальные машины или облачные экземпляры
* Обеспечение или масштабирование _infrastructure_, таких как гипервизоры с голой металлом или _compute nodes_
* Масштабирование или выход на пенсию виртуальных машин или облачных экземпляров

Каждый из них выполняется в контексте комплексного контроля доступа на основе ролей (RBAC), причем на уровне администратора одобрение выбранных автоматических операций, необходимых при необходимости.

Мы можем расширить или улучшить эти рабочие процессы по умолчанию и создать совершенно новые рабочие процессы оркестровки для удовлетворения наших конкретных требований.

===== Service Catalog

Мы можем создать каталоги самообслуживания, чтобы позволить пользователям заказать наши рабочие процессы оркестровки одним нажатием кнопки. Automate поставляется с интерактивным дизайнером диалога обслуживания, который мы используем для создания богатых диалогов, содержащих такие элементы, как текстовые поля, радиопроизводительные кнопки или раскрывающиеся списки. Эти элементы могут быть динамически заполнены значениями, которые являются специфическими и соответствующими для заказанного пользователя или рабочей нагрузки.

==== Integrate

В качестве расширения возможности автоматизации Cloudforms и Manageiq могут подключаться к и _integrate_ со многими корпоративными инструментами и системами. Обе системы поставляются с рубиновыми драгоценными камнями, чтобы позволить сценариям автоматизации подключаться как к API, так и с SOAP, а также библиотеки для подключения к нескольким базам данных SQL и LDAP, а также возможность запускать сценарии удаленного пауэрсхулью на серверах Windows.

Типичные действия интеграции могут заключаться в расширении рабочего процесса, обеспечивающего виртуальные машины для извлечения и использования IP -адреса из решения по управлению корпоративным IP -адресом (IPAM); Чтобы создать новую запись элемента конфигурации (CI) в базе данных центральной конфигурации (CMDB) или для создания и обновления билетов в инструменте управления сервисами предприятия, таких как ServiceNow.

=== The Appliance

Чтобы упростить установку, оба CloudForms управляют, распределяются в виде полностью установленных шаблонов виртуальных машин, часто называемых _Appliances_ для удобства. Устройство приходит предварительно сфигурировано со всем, что нам нужно. Appliance CloudForms 4.2 выполняет RHEL 7.3 (Centos 7.3 в случае Manageiq _euwe_), с PostgreSQL 9.5, Rails 5.0.0.1, приложение CloudForms/Manageiq и все связанные с ними установленные драгоценные камни Ruby. Устройства можно загрузить как шаблон изображения виртуальной машины в форматах, подходящих для VMware, виртуализации Red Hat Enterprise, OpenStack, Amazon EC2, Microsoft System Center Virtual Machine Manager или Azure Cloud и Google Compute Engine. Они также доступны в виде изображения контейнера Docker.

==== Ruby and Rails

Основное приложение «evmserverd» состоит из Ruby on Rails и использует PostgreSQL в качестве базы данных. Когда мы используем возможности автоматизации CloudForms или Manageiq, мы широко работаем с Ruby Language и пишем сценарии, которые взаимодействуют с моделью объекта Ruby, определяемой для нас двигателем автоматизации. Однако нам, конечно, не нужно быть разработчиками Rails (мы на самом деле не знаем что -либо знать о рельсах), но, как мы увидим в ссылке: ../../ peeping_under_the_hood/gace.asciidoc [заглядывая под капюшону], некоторые понимание концепций рельсов могут облегчить понимание объектной модели и того, что происходит за сцены, когда мы запускаем наши скрипты.

[NOTE]
Почему рельсы? Ruby On Rails-это мощная структура разработки для веб-приложений, ориентированных на базу данных. Он популярен для разработки продукта с открытым исходным кодом, например, _Foreman_, одного из основных компонентов продукта Red Hat _Satellite 6.x_, также является приложением Rails.

=== Projects, Products and Some History

Red Hat является компанией с открытым исходным кодом, и ее _products_ получены из одного или нескольких «восходящих» проектов с открытым исходным кодом. Manageiq - это проект Upstream для Red Hat Cloudforms.

==== ManageIQ (the _Project_)

Проект Manageiq выпускает новую версию каждые шесть месяцев (приблизительно). Каждая версия называется алфавитно после шахматного великого мастера, и до сих пор это были Ананд, Ботвинник, Капабланка, Дарга и Евве. На момент написания, Euwe - текущий стабильный релиз, и Fine находится в разработке.

==== Red Hat CloudForms (the _Product_)

Red Hat CloudForms 1.0 изначально была набором продуктов, включающих системный двигатель CloudForms, CloudForms Cloud Engine и CloudForms Configer, каждый со своим собственным проектом UPSTERA.

Когда Red Hat приобрела Manageiq (частная компания) в конце 2012 года, она решила прекратить разработку оригинальных проектов CloudForms 1.0: [Инвигал системы CloudForms System не полностью исчез. Он был основан на проекте Upstream _Katello_, который теперь является основной частью продукта Satellite 6.x Red Hat], и основывал новую версию, CloudForms 2.0, на гораздо более способном и зрелом Manageiq Enterprise Manager Manager Manager (EVM) 5.x. EVM 5.1 был повторно подключен в качестве CloudForms Management Engine 5.1.

Потребовалась Red Hat примерно через 18 месяцев с момента приобретения Manageiq, чтобы подготовить исходный код готовым к публикации в качестве проекта с открытым исходным кодом. После завершения проект Manageiq был сформирован, и разработка была запущена в выпуске _anand_.

==== CloudForms Management Engine (the _Appliance_)

_Cloudforms Management Engine_ - это имя виртуального устройства CloudForms, которое мы загружаем с Redhat.com. Самые последние версии двигателя управления CloudForms были основаны на соответствующих выпусках проекта Manageiq. Относительные версии и релизы суммированы в следующей таблице:

. Самоумление относительного проекта и версий продукта
[options="header"]
|=======
| Manageiq Project Release | Manageiq Sprints | версия двигателя Management CloudForms | версия CloudForms
|||5.1|2.0
|||5.2|3.0
| Ананд | 1 - 12 | 5,3 | 3.1
| Botvinnik | 13 - 22 | 5.4 | 3.2
| Capablanca | 23 - 33 | 5,5 | 4.0
| Дарга | 34 - 42 | 5,6 | 4.1
| Euwe | 43 - 51 | 5,7 | 4.2
|=======

=== Summary

В этой главе были представлены как CloudForms, так и Manageiq на довольно высоком уровне, но, надеемся, установила контекст продукта в сознании читателя. Остальная часть книги сосредоточена специально на автоматической функциональности двух инструментов. Давайте свернемся на рукавах и начнем!

==== Further Reading

https://www.redhat.com/en/technologies/cloud-computing/cloudforms= hat cloudforms]

https://allthingsopen.com/2015/04/09/a-technical-overview-of-red-hat-cloud-infrastructure-rhci/tcemancy Технический обзор инфраструктуры Cred Hat Cloud (RHCI)]]

https://www.forrester.com/report/the+forrester+wave+hybrid+cloud+management+solutions+Q1+2016/-/e-res122813= Forrester Wave ™: гибридные решения для управления облаком, Q1 2016]

https://github.com/manageiq/guides/blob/master/architecture/providers_overview.md= Руководство по архитектуре - Обзор провайдера]
